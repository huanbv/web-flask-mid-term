{% extends "base.html" %}

{% block content %}
    {{ center_main() }}

    <form action="" method="post"
        id="signup-form"
        class="py-5 px-9 rounded-md ajax"
        style="min-width: 350px; box-shadow: rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px;">

        {{ form.csrf_token }}


        {% for field in form if field.name != 'csrf_token' %}
        <div class="form-field py-2">

            <!-- .form-field-label -->
            <div class="form-field-label pb-0.5 text-gray-700">{{ field.label(class="text-sm font-medium") }}</div>

            <!-- .form-field-container -->
            <div class="form-field-container relative" data-name="{{ field.name }}">
                <div class="form-field-prefix absolute rounded-l flex justify-center items-center text-gray-400"
                    style="top: 1.85px; left: 1.75px; padding: 0.39rem">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4" />
                    </svg>
                </div>
                {{
                    field(
                        class_="
                        bg-transparent rounded-md
                        transition duration-300
                        w-full py-1 px-2 pl-8
                        border-2 border-gray-150
                        hover:bg-gray-100
                        focus:outline-none
                        focus:border-blue-400
                        focus:bg-white"
                    )
                }}
            </div>

            <!-- .form-field-errors-container -->
            <div class="form-field-errors-container">
                {% if field.errors %}
                    <script>
                        // adding the following error style classes to the input's class attribute
                        document.getElementById('{{ field.id }}').classList.add('bg-red-100', 'border-red-500');
                    </script>
                    {% for error in field.errors %}
                        <p class="form-field-error text-xs text-red-500">{{ error }}.</p>
                    {% endfor %}
                {% endif %}
            </div>
            
        </div> <!-- form-field -->
        {% endfor %}

        <button type="submit"
               class="
               flex justify-between items-center
               relative overflow-hidden cursor-pointer
               mx-auto mt-9 w-full
               rounded-md bg-gray-200
               text-gray-700 font-medium
               transition-all duration-300
               focus:outline-none
               focus:ring-2 focus:ring-offset-2 focus:ring-blue-400
               hover:bg-gray-300">

            <span class="flex-auto">Register</span>
            <span class="h-full p-2 bg-blue-500 text-white flex justify-center items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            </span>
        </button>
    </form>


    <style>
    </style>


    <script>
        // re-assign icon to the full_name field (hash (#) icon)
        $('#signup-form .form-field .form-field-container[data-name*="full_name"] .form-field-prefix').html(`
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" />
            </svg>`);


        passwordFieldsQuery = '#signup-form .form-field .form-field-container[data-name*="password"] .form-field-prefix';
        passwordFields = $(passwordFieldsQuery);
        $(passwordFields).addClass('cursor-pointer');

        lockSvg = `
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>`;
        unLockSvg = `
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z" />
            </svg>`;


        // setting the initial icon for password-like fields
        $(passwordFields).html(lockSvg);

        // binding the click event foreach password-like field
        $(passwordFields).each(function(index, elem) {
            $(this).click(function(e) {
                const theInput = $(this).next();
    
                if ($(theInput).attr('type') == 'text') {
                    $(theInput).attr('type', 'password');
                    $(this).html(lockSvg);
                } else {
                    $(theInput).attr('type', 'text');
                    $(this).html(unLockSvg);
                }
            });
        });


        // add password matching validation to the re_password field
        document.getElementById('re_password').addEventListener('input', function(e) {
            const passwordValue = $('#password').val();

            if (e.target.value != passwordValue) {
                e.target.setCustomValidity('This field must match with the Password field');
            } else {
                e.target.setCustomValidity('');
            }
        });
    </script>

{% endblock %}

